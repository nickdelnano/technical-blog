<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Revoking Redshift Superusers | My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="In recent years I have been tasked with administering a fleet of Redshift clusters. Once upon a time I was tasked with reducing the number of admin level users, or superusers as Redshift calls them. If you find yourself in a similar situation, know that there is a trap waiting for you. Now you will be aware of it.
If your organization has ever granted superuser access in any non-least privilege manner, you will likely have views owned by these users. Hopefully someday you apply least privilege to this part of your data infrastructure as Redshift superuser has access to everything within the cluster and likely parts of your data lake.">
    <meta name="generator" content="Hugo 0.138.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/revoking-redshift-superusers/">
    

    <meta property="og:url" content="http://localhost:1313/posts/revoking-redshift-superusers/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="Revoking Redshift Superusers">
  <meta property="og:description" content="In recent years I have been tasked with administering a fleet of Redshift clusters. Once upon a time I was tasked with reducing the number of admin level users, or superusers as Redshift calls them. If you find yourself in a similar situation, know that there is a trap waiting for you. Now you will be aware of it.
If your organization has ever granted superuser access in any non-least privilege manner, you will likely have views owned by these users. Hopefully someday you apply least privilege to this part of your data infrastructure as Redshift superuser has access to everything within the cluster and likely parts of your data lake.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-02T00:00:00-08:00">
    <meta property="article:modified_time" content="2024-04-02T00:00:00-08:00">

  <meta itemprop="name" content="Revoking Redshift Superusers">
  <meta itemprop="description" content="In recent years I have been tasked with administering a fleet of Redshift clusters. Once upon a time I was tasked with reducing the number of admin level users, or superusers as Redshift calls them. If you find yourself in a similar situation, know that there is a trap waiting for you. Now you will be aware of it.
If your organization has ever granted superuser access in any non-least privilege manner, you will likely have views owned by these users. Hopefully someday you apply least privilege to this part of your data infrastructure as Redshift superuser has access to everything within the cluster and likely parts of your data lake.">
  <meta itemprop="datePublished" content="2024-04-02T00:00:00-08:00">
  <meta itemprop="dateModified" content="2024-04-02T00:00:00-08:00">
  <meta itemprop="wordCount" content="271">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Revoking Redshift Superusers">
  <meta name="twitter:description" content="In recent years I have been tasked with administering a fleet of Redshift clusters. Once upon a time I was tasked with reducing the number of admin level users, or superusers as Redshift calls them. If you find yourself in a similar situation, know that there is a trap waiting for you. Now you will be aware of it.
If your organization has ever granted superuser access in any non-least privilege manner, you will likely have views owned by these users. Hopefully someday you apply least privilege to this part of your data infrastructure as Redshift superuser has access to everything within the cluster and likely parts of your data lake.">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Revoking Redshift Superusers</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-04-02T00:00:00-08:00">April 2, 2024</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>In recent years I have been tasked with administering a fleet of Redshift clusters. Once upon a time I was tasked with reducing the number of admin level users, or <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_superusers.html">superusers</a> as Redshift calls them. If you find yourself in a similar situation, know that there is a trap waiting for you. Now you will be aware of it.</p>
<p>If your organization has ever granted superuser access in any non-least privilege manner, you will likely have views owned by these users. Hopefully someday you apply least privilege to this part of your data infrastructure as Redshift superuser has access to everything within the cluster and likely parts of your data lake.</p>
<p><strong>Before revoking superuser access for user X, confirm that X has SELECT privileges on all dependent objects in the views it owns.</strong> Otherwise it is relying on the superuser privilege for this, and without it, queries from any user on the view will fail.</p>
<blockquote>
<p>[42501] ERROR: permission denied for relation view_name</p>
</blockquote>
<p>That is - permission denied for the view owner! Not the user of <em>select current_user;</em></p>
<p>Non-intuitive, right? The <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_VIEW.html">CREATE VIEW page</a> of the manual is missing some content; it mentions the requirement for late-binding views but it applies to regular views too.</p>
<p>I prefer a convention that all views are owned by a service user or the cluster root user. Data users submit DDL through a code reviewed process and the data platform team (or their automation) executes the DDL, including setting an appropriate owner.</p>
<p>If you trace through the system tables or the user activity log, you will see what Redshift is using the view owner user for.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  My New Hugo Site 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
